<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Student Dashboard - Student Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "m3-surface": "#111318",
                        "m3-surface-container": "#1d2024",
                        "m3-surface-container-high": "#282a2f",
                        "m3-on-surface": "#e2e2e9",
                        "m3-on-surface-variant": "#c4c7d0",
                        "m3-outline": "#8e9099",
                        "m3-primary": "#a8c7fa",
                        "m3-on-primary": "#002f65",
                        "m3-primary-container": "#00478f",
                        "m3-on-primary-container": "#d7e3ff",
                        "m3-secondary": "#7fcfff",
                        "m3-on-secondary": "#003355",
                        "m3-secondary-container": "#004b73",
                        "m3-on-secondary-container": "#cce5ff",
                        "m3-tertiary": "#dcbce9",
                        "m3-tertiary-container": "#563e63",
                        "m3-on-tertiary-container": "#f8d8ff",
                        "m3-error": "#ffb4ab",
                    },
                    fontFamily: {
                        "sans": ["Roboto", "sans-serif"],
                    },
                    boxShadow: {
                        'm3-elevation-1': '0px 1px 3px 1px rgba(0, 0, 0, 0.15), 0px 1px 2px 0px rgba(0, 0, 0, 0.30)',
                        'm3-elevation-2': '0px 2px 6px 2px rgba(0, 0, 0, 0.15), 0px 1px 2px 0px rgba(0, 0, 0, 0.30)',
                    }
                },
            },
        }
    </script>
    <style>
        .nav-item.active .icon-container {
            background-color: theme('colors.m3-secondary-container');
            color: theme('colors.m3-on-secondary-container');
        }

        .nav-item.active span.material-symbols-outlined {
            font-variation-settings: 'FILL' 1, 'wght' 600;
        }

        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #44474d;
            border-radius: 4px;
        }
    </style>
</head>

<body
    class="bg-m3-surface text-m3-on-surface font-sans h-screen flex overflow-hidden selection:bg-m3-primary selection:text-m3-on-primary">
    <!-- Desktop Navigation Rail -->
    <aside
        class="hidden md:flex flex-col items-center py-8 w-[80px] bg-m3-surface-container border-r border-m3-outline/5 z-20 shrink-0">
        <div class="mb-8">
            <button class="p-3 rounded-full hover:bg-white/5 transition-colors text-m3-on-surface">
                <span class="material-symbols-outlined">menu</span>
            </button>
        </div>
        <nav class="flex flex-col gap-4 w-full items-center">
            <a class="nav-item active flex flex-col items-center gap-1 group w-full px-2" href="/">
                <div
                    class="icon-container w-14 h-8 rounded-full flex items-center justify-center transition-colors duration-200">
                    <span class="material-symbols-outlined text-2xl">dashboard</span>
                </div>
                <span
                    class="text-[12px] font-medium text-m3-on-surface-variant group-hover:text-m3-on-surface transition-colors">Home</span>
            </a>
            <a class="nav-item flex flex-col items-center gap-1 group w-full px-2" href="#">
                <div
                    class="icon-container w-14 h-8 rounded-full flex items-center justify-center hover:bg-white/5 transition-colors text-m3-on-surface-variant">
                    <span class="material-symbols-outlined text-2xl">book</span>
                </div>
                <span
                    class="text-[12px] font-medium text-m3-on-surface-variant group-hover:text-m3-on-surface transition-colors">Courses</span>
            </a>
            <a class="nav-item flex flex-col items-center gap-1 group w-full px-2" href="#">
                <div
                    class="icon-container w-14 h-8 rounded-full flex items-center justify-center hover:bg-white/5 transition-colors text-m3-on-surface-variant">
                    <span class="material-symbols-outlined text-2xl">bar_chart</span>
                </div>
                <span
                    class="text-[12px] font-medium text-m3-on-surface-variant group-hover:text-m3-on-surface transition-colors">Grades</span>
            </a>
            <a class="nav-item flex flex-col items-center gap-1 group w-full px-2" href="#">
                <div
                    class="icon-container w-14 h-8 rounded-full flex items-center justify-center hover:bg-white/5 transition-colors text-m3-on-surface-variant">
                    <span class="material-symbols-outlined text-2xl">calendar_month</span>
                </div>
                <span
                    class="text-[12px] font-medium text-m3-on-surface-variant group-hover:text-m3-on-surface transition-colors">Schedule</span>
            </a>
        </nav>
        <div class="mt-auto flex flex-col items-center gap-4">
            <a href="/logout"
                class="w-10 h-10 rounded-full bg-m3-primary/20 flex items-center justify-center ring-1 ring-m3-outline/20 hover:ring-m3-primary/50 transition-all cursor-pointer">
                <span class="material-symbols-outlined text-m3-primary">logout</span>
            </a>
        </div>
    </aside>

    <!-- Mobile Bottom Navigation -->
    <nav
        class="md:hidden fixed bottom-0 left-0 right-0 h-20 bg-m3-surface-container border-t border-m3-outline/10 z-50 flex justify-around items-center px-4">
        <a class="flex flex-col items-center gap-1 group" href="/">
            <div class="w-16 h-8 rounded-full bg-m3-secondary-container flex items-center justify-center">
                <span class="material-symbols-outlined text-m3-on-secondary-container text-2xl"
                    style="font-variation-settings: 'FILL' 1;">dashboard</span>
            </div>
            <span class="text-[12px] font-bold text-m3-on-surface">Home</span>
        </a>
        <a class="flex flex-col items-center gap-1 group text-m3-on-surface-variant" href="#">
            <div class="w-16 h-8 rounded-full flex items-center justify-center">
                <span class="material-symbols-outlined text-2xl">book</span>
            </div>
            <span class="text-[12px] font-medium">Courses</span>
        </a>
        <a class="flex flex-col items-center gap-1 group text-m3-on-surface-variant" href="#">
            <div class="w-16 h-8 rounded-full flex items-center justify-center">
                <span class="material-symbols-outlined text-2xl">bar_chart</span>
            </div>
            <span class="text-[12px] font-medium">Grades</span>
        </a>
        <a class="flex flex-col items-center gap-1 group text-m3-on-surface-variant" href="/logout">
            <div class="w-16 h-8 rounded-full flex items-center justify-center">
                <span class="material-symbols-outlined text-2xl">logout</span>
            </div>
            <span class="text-[12px] font-medium">Exit</span>
        </a>
    </nav>

    <main class="flex-1 flex flex-col h-full overflow-hidden relative bg-m3-surface">
        <div class="flex-1 overflow-y-auto overflow-x-hidden p-4 md:p-6 lg:p-8 pb-24 md:pb-8 scroll-smooth">
            <div class="max-w-[1600px] mx-auto flex flex-col gap-6">
                <!-- Mobile Header -->
                <div class="md:hidden flex justify-between items-center mb-4">
                    <span class="text-xl font-normal text-m3-on-surface">Student Portal</span>
                </div>

                <!-- Hero Header -->
                <header
                    class="flex flex-wrap justify-between items-end gap-6 rounded-[28px] bg-gradient-to-br from-purple-900/40 to-m3-surface-container p-6 md:p-10">
                    <div class="flex flex-col gap-4 max-w-2xl">
                        <div>
                            <h2 class="text-m3-on-surface-variant text-sm font-medium tracking-wider uppercase mb-2">
                                Overview</h2>
                            <h1
                                class="text-4xl md:text-5xl lg:text-[57px] font-normal text-m3-on-surface leading-[1.1] tracking-[-0.5px]">
                                Welcome back, <br /><span class="font-normal text-m3-primary">
                                    <%= user.fullname.split(' ')[0] %></span>
                            </h1>
                        </div>
                        <p class="text-lg text-m3-on-surface-variant font-normal max-w-lg leading-relaxed">
                            You have <span class="text-m3-on-secondary bg-m3-secondary-container px-2 py-1 rounded text-sm font-bold align-middle mx-1"><%= assignments.filter(a => a.status === '
                                        pending').length %> tasks
                                </span> pending today.
                                </p>
                        </div>
                        <div
                            class="flex items-center gap-3 bg-m3-secondary-container text-m3-on-secondary-container px-5 py-3 rounded-2xl shadow-sm">
                            <span class="material-symbols-outlined text-xl">calendar_today</span>
                            <p class="text-base font-medium">Fall Semester â€¢ Week 8</p>
                        </div>
                </header>

                <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
                    <!-- Main Content Area -->
                    <div class="lg:col-span-8 flex flex-col gap-6">
                        <!-- Stats Cards -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <!-- CGPA Card -->
                            <div
                                class="bg-m3-surface-container-high rounded-[24px] p-6 relative overflow-hidden group hover:shadow-lg transition-shadow">
                                <div class="flex flex-col h-full justify-between relative z-10">
                                    <div class="flex justify-between items-start">
                                        <p class="text-m3-on-surface-variant text-sm font-medium">Average Grade</p>
                                        <div
                                            class="bg-m3-primary/20 text-m3-primary text-xs px-2 py-1 rounded-md flex items-center gap-1">
                                            <span class="material-symbols-outlined text-[14px]">trending_up</span>
                                            Good
                                        </div>
                                    </div>
                                    <div class="mt-4">
                                        <% const avgGrade=marks.length> 0 ? Math.round(marks.reduce((sum, m) => sum +
                                            m.marks, 0) / marks.length) : 0;
                                            %>
                                            <p class="text-[45px] leading-none font-normal text-m3-on-surface">
                                                <%= avgGrade %>%
                                            </p>
                                            <p class="text-m3-on-surface-variant text-xs mt-2">Based on <%= marks.length
                                                    %> subjects</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Attendance Card -->
                            <div
                                class="bg-m3-surface-container-high rounded-[24px] p-6 flex flex-col items-center justify-center relative hover:shadow-lg transition-shadow">
                                <div class="w-full flex justify-between items-center mb-2">
                                    <p class="text-m3-on-surface-variant text-sm font-medium">Attendance</p>
                                    <span class="material-symbols-outlined text-m3-outline text-lg">fact_check</span>
                                </div>
                                <div class="relative size-24 flex items-center justify-center">
                                    <svg class="size-full transform -rotate-90">
                                        <circle class="text-m3-surface-container" cx="50%" cy="50%" fill="transparent"
                                            r="40" stroke="currentColor" stroke-width="8"></circle>
                                        <% const circumference=2 * Math.PI * 40; const offset=circumference * ((100 -
                                            attendancePercentage) / 100); %>
                                            <circle class="text-m3-secondary" cx="50%" cy="50%" fill="transparent"
                                                r="40" stroke="currentColor" stroke-dasharray="<%= circumference %>"
                                                stroke-dashoffset="<%= offset %>" stroke-linecap="round"
                                                stroke-width="8"></circle>
                                    </svg>
                                    <div class="absolute inset-0 flex items-center justify-center">
                                        <span class="text-2xl font-bold text-m3-on-surface">
                                            <%= attendancePercentage %>%
                                        </span>
                                    </div>
                                </div>
                                <p class="text-m3-on-surface-variant text-xs mt-3">
                                    <%= presentDays %>/<%= totalDays %> days
                                </p>
                            </div>

                            <!-- Pending Tasks Card -->
                            <div
                                class="bg-m3-surface-container rounded-[24px] border border-m3-outline/20 p-5 flex flex-col hover:bg-m3-surface-container-high transition-colors">
                                <div class="flex justify-between items-center mb-4">
                                    <p class="text-m3-on-surface font-medium">Pending</p>
                                    <div
                                        class="size-6 bg-m3-error text-m3-surface rounded-full flex items-center justify-center text-xs font-bold">
                                        <%= assignments.filter(a=> a.status === 'pending').length %>
                                    </div>
                                </div>
                                <div class="flex flex-col gap-3 overflow-y-auto flex-1">
                                    <% assignments.filter(a=> a.status === 'pending').slice(0, 2).forEach(assignment =>
                                        { %>
                                        <div class="flex items-start gap-3">
                                            <div class="mt-1.5 w-2 h-2 rounded-full bg-m3-error"></div>
                                            <div class="flex flex-col">
                                                <span class="text-sm text-m3-on-surface">
                                                    <%= assignment.title.substring(0, 30) %>...
                                                </span>
                                                <span class="text-[11px] text-m3-on-surface-variant">Due <%= new
                                                        Date(assignment.due_date).toLocaleDateString() %></span>
                                            </div>
                                        </div>
                                        <% }); %>
                                </div>
                            </div>
                        </div>

                        <!-- Performance Chart -->
                        <div class="bg-m3-surface-container rounded-[24px] p-6 lg:p-8 flex flex-col gap-6">
                            <div class="flex justify-between items-center">
                                <h3 class="text-xl font-normal text-m3-on-surface">Academic Performance</h3>
                            </div>
                            <div class="relative h-56 w-full flex items-end justify-between px-2 gap-2 sm:gap-6 pt-8">
                                <div
                                    class="absolute inset-0 flex flex-col justify-between pointer-events-none opacity-10">
                                    <div class="w-full h-px bg-m3-on-surface"></div>
                                    <div class="w-full h-px bg-m3-on-surface"></div>
                                    <div class="w-full h-px bg-m3-on-surface"></div>
                                    <div class="w-full h-px bg-m3-on-surface"></div>
                                    <div class="w-full h-px bg-m3-on-surface"></div>
                                </div>
                                <% marks.forEach((mark, idx)=> {
                                    const height = mark.marks + '%';
                                    const isHighest = mark.marks === Math.max(...marks.map(m => m.marks));
                                    %>
                                    <div class="flex-1 flex flex-col justify-end group cursor-pointer relative z-10">
                                        <div class="w-full <%= isHighest ? 'bg-m3-primary' : 'bg-m3-surface-container-high' %> rounded-t-lg transition-all duration-300 group-hover:bg-m3-primary/50"
                                            style="height: <%= height %>">
                                            <div
                                                class="absolute -top-8 left-1/2 -translate-x-1/2 bg-m3-surface-container-high px-2 py-1 rounded text-xs text-m3-on-surface opacity-0 group-hover:opacity-100 transition-opacity">
                                                <%= mark.marks %>
                                            </div>
                                        </div>
                                        <p
                                            class="text-xs text-center <%= isHighest ? 'text-m3-primary font-bold' : 'text-m3-on-surface-variant' %> mt-3 font-medium">
                                            <%= mark.subject.substring(0, 6) %>
                                        </p>
                                    </div>
                                    <% }); %>
                            </div>
                        </div>
                    </div>

                    <!-- Sidebar -->
                    <div class="lg:col-span-4 flex flex-col gap-6">
                        <!-- Today's Schedule -->
                        <div class="bg-m3-surface-container rounded-[24px] p-6 flex flex-col h-full min-h-[400px]">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-xl font-normal text-m3-on-surface">Today's Schedule</h3>
                            </div>
                            <div class="flex flex-col relative h-full gap-6 pl-2">
                                <div class="absolute left-[70px] top-2 bottom-4 w-0.5 bg-m3-outline/20"></div>
                                <div class="flex gap-4 relative">
                                    <div class="w-14 text-right pt-2">
                                        <p class="text-m3-on-surface font-bold text-sm">09:00</p>
                                        <p class="text-m3-on-surface-variant text-[10px]">AM</p>
                                    </div>
                                    <div class="relative z-10 pt-2.5">
                                        <div
                                            class="size-3 bg-m3-primary rounded-full ring-4 ring-m3-surface-container shadow-sm">
                                        </div>
                                    </div>
                                    <div
                                        class="flex-1 bg-m3-surface-container-high p-4 rounded-xl border-l-4 border-m3-primary shadow-sm">
                                        <h4 class="text-m3-primary font-bold text-sm">Mathematics</h4>
                                        <p class="text-m3-on-surface-variant text-xs mt-1 flex items-center gap-1">
                                            <span class="material-symbols-outlined text-[14px]">location_on</span>
                                            Room 302
                                        </p>
                                    </div>
                                </div>
                                <div class="flex gap-4 relative opacity-50">
                                    <div class="w-14"></div>
                                    <div class="relative z-10 pt-1">
                                        <div class="size-2 bg-m3-outline rounded-full ml-0.5"></div>
                                    </div>
                                    <div class="flex-1">
                                        <p class="text-m3-on-surface-variant text-xs italic">End of classes</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Mini Calendar -->
                        <div class="bg-m3-surface-container rounded-[24px] p-6 flex flex-col gap-4">
                            <div class="flex justify-between items-center">
                                <div>
                                    <p class="text-xs font-bold text-m3-on-surface-variant uppercase tracking-wider">
                                        <%= new Date().toLocaleDateString('en-US', { month: 'long' }) %>
                                    </p>
                                    <p class="text-3xl font-normal text-m3-on-surface">
                                        <%= new Date().getDate() %>
                                    </p>
                                </div>
                                <button class="p-2 rounded-full hover:bg-m3-surface-container-high transition-colors">
                                    <span class="material-symbols-outlined text-m3-on-surface">calendar_month</span>
                                </button>
                            </div>
                            <div class="grid grid-cols-7 gap-1 text-center text-xs text-m3-on-surface-variant mt-2">
                                <span>S</span><span>M</span><span>T</span><span>W</span><span>T</span><span>F</span><span>S</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</body>

</html>